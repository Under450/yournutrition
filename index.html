<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutrition Tracker - UK & Global Food Databases</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #4CAF50;
            --primary-dark: #388E3C;
            --secondary: #2196F3;
            --danger: #F44336;
            --warning: #FF9800;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 0;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 8px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .goal-input {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        
        .goal-input label {
            font-weight: 600;
        }
        
        .goal-input input {
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            width: 180px;
        }
        
        .goal-input button {
            background-color: var(--primary-dark);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .goal-input button:hover {
            background-color: #2e7d32;
            transform: translateY(-2px);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 992px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--secondary);
        }
        
        .databases {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .db-btn {
            padding: 10px 20px;
            background-color: var(--light-gray);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .db-btn.active {
            background-color: var(--secondary);
            color: white;
        }
        
        .db-btn:hover {
            background-color: var(--secondary);
            color: white;
        }
        
        .search-box {
            margin-bottom: 20px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 15px 15px 15px 50px;
            border: 1px solid var(--light-gray);
            border-radius: 10px;
            font-size: 1rem;
            background-color: var(--light);
        }
        
        .search-box i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .food-results {
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid var(--light-gray);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        .food-item {
            padding: 15px;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .food-item:hover {
            background-color: var(--light);
        }
        
        .food-item:last-child {
            border-bottom: none;
        }
        
        .food-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .food-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .meal-section {
            margin-bottom: 30px;
        }
        
        .meal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
        }
        
        .meal-title {
            font-size: 1.3rem;
            color: var(--primary-dark);
        }
        
        .meal-foods {
            min-height: 80px;
            border: 1px dashed var(--light-gray);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .meal-food-item {
            background-color: var(--light);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .meal-food-item:last-child {
            margin-bottom: 0;
        }
        
        .remove-food {
            color: var(--danger);
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.1rem;
        }
        
        .nutrition-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .nutrition-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .nutrition-card {
            text-align: center;
            padding: 20px 15px;
            border-radius: 10px;
            color: white;
        }
        
        .nutrition-card.protein {
            background-color: #4CAF50;
        }
        
        .nutrition-card.carbs {
            background-color: #2196F3;
        }
        
        .nutrition-card.fat {
            background-color: #FF9800;
        }
        
        .nutrition-card.sugar {
            background-color: #F44336;
        }
        
        .nutrition-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .nutrition-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .calorie-total {
            text-align: center;
            margin-top: 25px;
            padding: 20px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .calorie-value {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--primary-dark);
            margin-bottom: 10px;
        }
        
        .calorie-goal {
            font-size: 1.2rem;
            color: var(--gray);
        }
        
        .calorie-difference {
            font-size: 1.3rem;
            font-weight: 600;
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
        }
        
        .calorie-deficit {
            background-color: rgba(76, 175, 80, 0.2);
            color: var(--primary-dark);
        }
        
        .calorie-surplus {
            background-color: rgba(244, 67, 54, 0.2);
            color: var(--danger);
        }
        
        .chart-container {
            height: 300px;
            margin-top: 20px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .database-info {
            margin-top: 10px;
            font-size: 0.85rem;
        }
        
        .empty-state {
            text-align: center;
            color: var(--gray);
            padding: 30px 0;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div>
                    <h1><i class="fas fa-utensils"></i> Nutrition Tracker</h1>
                    <p class="subtitle">Track your meals with free UK & global food databases</p>
                </div>
                <div class="goal-input">
                    <label for="calorie-goal">Daily Calorie Goal:</label>
                    <input type="number" id="calorie-goal" placeholder="e.g., 2000" value="2000">
                    <button id="set-goal">Set Goal</button>
                </div>
            </div>
        </div>
    </header>
    
    <main class="container">
        <div class="dashboard">
            <div class="card">
                <h2 class="card-title"><i class="fas fa-search"></i> Food Database</h2>
                
                <div class="databases">
                    <button class="db-btn active" data-db="uk">
                        <i class="fas fa-flag-uk"></i> UK Database
                    </button>
                    <button class="db-btn" data-db="global">
                        <i class="fas fa-globe"></i> Global Database
                    </button>
                    <button class="db-btn" data-db="usda">
                        <i class="fas fa-database"></i> USDA Database
                    </button>
                </div>
                
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="food-search" placeholder="Search for foods (e.g., banana, chicken breast)">
                </div>
                
                <div class="food-results" id="food-results">
                    <!-- Food search results will appear here -->
                    <div class="empty-state">
                        <i class="fas fa-search"></i>
                        <p>Search for foods using the input above</p>
                    </div>
                </div>
                
                <div class="nutrition-summary">
                    <div class="nutrition-card protein">
                        <div class="nutrition-value" id="protein-value">0g</div>
                        <div class="nutrition-label">Protein</div>
                    </div>
                    <div class="nutrition-card carbs">
                        <div class="nutrition-value" id="carbs-value">0g</div>
                        <div class="nutrition-label">Carbs</div>
                    </div>
                    <div class="nutrition-card fat">
                        <div class="nutrition-value" id="fat-value">0g</div>
                        <div class="nutrition-label">Fat</div>
                    </div>
                    <div class="nutrition-card sugar">
                        <div class="nutrition-value" id="sugar-value">0g</div>
                        <div class="nutrition-label">Sugar</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title"><i class="fas fa-chart-pie"></i> Nutrition Chart</h2>
                <div class="chart-container">
                    <canvas id="nutrition-chart"></canvas>
                </div>
                
                <div class="calorie-total">
                    <div class="calorie-value" id="total-calories">0</div>
                    <div class="calorie-label">Total Calories Today</div>
                    <div class="calorie-goal">Goal: <span id="goal-display">2000</span> calories</div>
                    <div class="calorie-difference calorie-deficit" id="calorie-difference">
                        -2000 calories remaining
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title"><i class="fas fa-calendar-day"></i> Today's Meals</h2>
            
            <div class="meal-section">
                <div class="meal-header">
                    <h3 class="meal-title"><i class="fas fa-sun"></i> Breakfast</h3>
                    <span class="meal-calories" id="breakfast-calories">0 calories</span>
                </div>
                <div class="meal-foods" id="breakfast-foods">
                    <div class="empty-state">
                        <i class="fas fa-plus-circle"></i>
                        <p>Add foods from the database</p>
                    </div>
                </div>
            </div>
            
            <div class="meal-section">
                <div class="meal-header">
                    <h3 class="meal-title"><i class="fas fa-cloud-sun"></i> Lunch</h3>
                    <span class="meal-calories" id="lunch-calories">0 calories</span>
                </div>
                <div class="meal-foods" id="lunch-foods">
                    <div class="empty-state">
                        <i class="fas fa-plus-circle"></i>
                        <p>Add foods from the database</p>
                    </div>
                </div>
            </div>
            
            <div class="meal-section">
                <div class="meal-header">
                    <h3 class="meal-title"><i class="fas fa-moon"></i> Dinner</h3>
                    <span class="meal-calories" id="dinner-calories">0 calories</span>
                </div>
                <div class="meal-foods" id="dinner-foods">
                    <div class="empty-state">
                        <i class="fas fa-plus-circle"></i>
                        <p>Add foods from the database</p>
                    </div>
                </div>
            </div>
            
            <div class="meal-section">
                <div class="meal-header">
                    <h3 class="meal-title"><i class="fas fa-cookie-bite"></i> Snacks</h3>
                    <span class="meal-calories" id="snacks-calories">0 calories</span>
                </div>
                <div class="meal-foods" id="snacks-foods">
                    <div class="empty-state">
                        <i class="fas fa-plus-circle"></i>
                        <p>Add foods from the database</p>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="container">
        <p>Nutrition Tracker uses free food databases from the UK, USDA, and Open Food Facts</p>
        <div class="database-info">
            <p>UK Database: Public Health England | Global: Open Food Facts | USDA: FoodData Central</p>
        </div>
        <p>Â© 2023 Nutrition Tracker. This tool is for educational purposes only.</p>
    </footer>

    <script>
        // Food database simulation (in a real app, this would be API calls)
        const foodDatabases = {
            uk: [
                { id: 1, name: "Banana", calories: 105, protein: 1.3, carbs: 27, fat: 0.4, sugar: 14, database: "UK" },
                { id: 2, name: "Chicken Breast (100g)", calories: 165, protein: 31, carbs: 0, fat: 3.6, sugar: 0, database: "UK" },
                { id: 3, name: "Whole Milk (250ml)", calories: 155, protein: 8, carbs: 12, fat: 8, sugar: 12, database: "UK" },
                { id: 4, name: "Wholemeal Bread (slice)", calories: 128, protein: 4.4, carbs: 24, fat: 1.2, sugar: 2.1, database: "UK" },
                { id: 5, name: "Eggs (large)", calories: 78, protein: 6.3, carbs: 0.6, fat: 5.3, sugar: 0.1, database: "UK" },
                { id: 6, name: "Apple", calories: 95, protein: 0.5, carbs: 25, fat: 0.3, sugar: 19, database: "UK" },
                { id: 7, name: "Pasta (cooked, 100g)", calories: 131, protein: 5, carbs: 25, fat: 1, sugar: 0.6, database: "UK" },
                { id: 8, name: "Greek Yogurt (100g)", calories: 97, protein: 9, carbs: 4, fat: 5, sugar: 4, database: "UK" }
            ],
            global: [
                { id: 9, name: "Avocado", calories: 160, protein: 2, carbs: 9, fat: 15, sugar: 0.7, database: "Global" },
                { id: 10, name: "Salmon (100g)", calories: 208, protein: 20, carbs: 0, fat: 13, sugar: 0, database: "Global" },
                { id: 11, name: "Brown Rice (cooked, 100g)", calories: 111, protein: 2.6, carbs: 23, fat: 0.9, sugar: 0.4, database: "Global" },
                { id: 12, name: "Broccoli (100g)", calories: 34, protein: 2.8, carbs: 7, fat: 0.4, sugar: 1.7, database: "Global" },
                { id: 13, name: "Almonds (28g)", calories: 164, protein: 6, carbs: 6, fat: 14, sugar: 1, database: "Global" },
                { id: 14, name: "Orange", calories: 62, protein: 1.2, carbs: 15, fat: 0.2, sugar: 12, database: "Global" },
                { id: 15, name: "Quinoa (cooked, 100g)", calories: 120, protein: 4.4, carbs: 21, fat: 1.9, sugar: 0.9, database: "Global" },
                { id: 16, name: "Dark Chocolate (28g)", calories: 170, protein: 2, carbs: 13, fat: 12, sugar: 7, database: "Global" }
            ],
            usda: [
                { id: 17, name: "Ground Beef (85% lean, 100g)", calories: 250, protein: 17, carbs: 0, fat: 20, sugar: 0, database: "USDA" },
                { id: 18, name: "Sweet Potato (100g)", calories: 86, protein: 1.6, carbs: 20, fat: 0.1, sugar: 4.2, database: "USDA" },
                { id: 19, name: "Spinach (raw, 100g)", calories: 23, protein: 2.9, carbs: 3.6, fat: 0.4, sugar: 0.4, database: "USDA" },
                { id: 20, name: "Blueberries (100g)", calories: 57, protein: 0.7, carbs: 14, fat: 0.3, sugar: 10, database: "USDA" },
                { id: 21, name: "Oatmeal (cooked, 100g)", calories: 71, protein: 2.5, carbs: 12, fat: 1.5, sugar: 0.5, database: "USDA" },
                { id: 22, name: "Cheddar Cheese (28g)", calories: 115, protein: 7, carbs: 0.4, fat: 9, sugar: 0.1, database: "USDA" },
                { id: 23, name: "Tuna (canned in water, 100g)", calories: 116, protein: 26, carbs: 0, fat: 1, sugar: 0, database: "USDA" },
                { id: 24, name: "Carrot (medium)", calories: 25, protein: 0.6, carbs: 6, fat: 0.1, sugar: 3, database: "USDA" }
            ]
        };

        // State variables
        let currentDatabase = 'uk';
        let selectedMeal = 'breakfast';
        let dailyGoal = 2000;
        let meals = {
            breakfast: [],
            lunch: [],
            dinner: [],
            snacks: []
        };

        // DOM Elements
        const foodSearch = document.getElementById('food-search');
        const foodResults = document.getElementById('food-results');
        const dbButtons = document.querySelectorAll('.db-btn');
        const calorieGoalInput = document.getElementById('calorie-goal');
        const setGoalButton = document.getElementById('set-goal');
        const goalDisplay = document.getElementById('goal-display');
        const calorieDifference = document.getElementById('calorie-difference');
        const mealContainers = {
            breakfast: document.getElementById('breakfast-foods'),
            lunch: document.getElementById('lunch-foods'),
            dinner: document.getElementById('dinner-foods'),
            snacks: document.getElementById('snacks-foods')
        };
        const mealCalories = {
            breakfast: document.getElementById('breakfast-calories'),
            lunch: document.getElementById('lunch-calories'),
            dinner: document.getElementById('dinner-calories'),
            snacks: document.getElementById('snacks-calories')
        };

        // Nutrition values
        const proteinValue = document.getElementById('protein-value');
        const carbsValue = document.getElementById('carbs-value');
        const fatValue = document.getElementById('fat-value');
        const sugarValue = document.getElementById('sugar-value');
        const totalCaloriesElem = document.getElementById('total-calories');

        // Chart initialization
        let nutritionChart = null;
        const ctx = document.getElementById('nutrition-chart').getContext('2d');
        
        // Initialize chart
        function initializeChart() {
            if (nutritionChart) {
                nutritionChart.destroy();
            }
            
            nutritionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Protein', 'Carbs', 'Fat', 'Sugar'],
                    datasets: [{
                        data: [0, 0, 0, 0],
                        backgroundColor: [
                            '#4CAF50',
                            '#2196F3',
                            '#FF9800',
                            '#F44336'
                        ],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw}g`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Update chart with current nutrition data
        function updateChart() {
            const totals = calculateTotals();
            
            if (nutritionChart) {
                nutritionChart.data.datasets[0].data = [
                    totals.protein,
                    totals.carbs,
                    totals.fat,
                    totals.sugar
                ];
                nutritionChart.update();
            }
        }

        // Set up event listeners
        function initializeEventListeners() {
            // Database buttons
            dbButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    dbButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    currentDatabase = this.getAttribute('data-db');
                    searchFoods();
                });
            });

            // Food search
            foodSearch.addEventListener('input', searchFoods);

            // Set calorie goal
            setGoalButton.addEventListener('click', setCalorieGoal);
            calorieGoalInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    setCalorieGoal();
                }
            });

            // Meal selection (when user clicks on a meal container)
            for (const meal in mealContainers) {
                mealContainers[meal].addEventListener('click', function() {
                    selectedMeal = meal;
                    highlightSelectedMeal();
                });
            }

            // Initialize with some sample data for demo
            initializeSampleData();
        }

        // Search foods based on input and selected database
        function searchFoods() {
            const searchTerm = foodSearch.value.toLowerCase();
            const database = foodDatabases[currentDatabase];
            
            // Filter foods based on search term
            const filteredFoods = database.filter(food => 
                food.name.toLowerCase().includes(searchTerm)
            );
            
            // Display results
            displayFoodResults(filteredFoods);
        }

        // Display food search results
        function displayFoodResults(foods) {
            foodResults.innerHTML = '';
            
            if (foods.length === 0) {
                foodResults.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-search"></i>
                        <p>No foods found. Try a different search term.</p>
                    </div>
                `;
                return;
            }
            
            foods.forEach(food => {
                const foodItem = document.createElement('div');
                foodItem.className = 'food-item';
                foodItem.innerHTML = `
                    <div class="food-name">${food.name}</div>
                    <div class="food-details">
                        <span>${food.calories} cal</span>
                        <span>P: ${food.protein}g | C: ${food.carbs}g | F: ${food.fat}g</span>
                    </div>
                `;
                
                foodItem.addEventListener('click', function() {
                    addFoodToMeal(food);
                });
                
                foodResults.appendChild(foodItem);
            });
        }

        // Add food to selected meal
        function addFoodToMeal(food) {
            meals[selectedMeal].push(food);
            updateMealDisplay();
            updateNutritionSummary();
            updateChart();
            
            // Show a brief confirmation
            const originalText = foodSearch.placeholder;
            foodSearch.placeholder = `Added ${food.name} to ${selectedMeal}`;
            setTimeout(() => {
                foodSearch.placeholder = originalText;
            }, 1500);
        }

        // Remove food from meal
        function removeFoodFromMeal(meal, index) {
            meals[meal].splice(index, 1);
            updateMealDisplay();
            updateNutritionSummary();
            updateChart();
        }

        // Update the display for all meals
        function updateMealDisplay() {
            for (const meal in meals) {
                const container = mealContainers[meal];
                const foods = meals[meal];
                
                if (foods.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-plus-circle"></i>
                            <p>Add foods from the database</p>
                        </div>
                    `;
                    mealCalories[meal].textContent = '0 calories';
                } else {
                    container.innerHTML = '';
                    let mealCal = 0;
                    
                    foods.forEach((food, index) => {
                        const foodItem = document.createElement('div');
                        foodItem.className = 'meal-food-item';
                        foodItem.innerHTML = `
                            <div>
                                <strong>${food.name}</strong>
                                <div style="font-size: 0.85rem; color: var(--gray);">
                                    ${food.calories} cal | P: ${food.protein}g | C: ${food.carbs}g | F: ${food.fat}g
                                </div>
                            </div>
                            <button class="remove-food" data-meal="${meal}" data-index="${index}">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        
                        container.appendChild(foodItem);
                        mealCal += food.calories;
                    });
                    
                    mealCalories[meal].textContent = `${mealCal} calories`;
                    
                    // Add event listeners to remove buttons
                    container.querySelectorAll('.remove-food').forEach(button => {
                        button.addEventListener('click', function(e) {
                            e.stopPropagation();
                            const meal = this.getAttribute('data-meal');
                            const index = parseInt(this.getAttribute('data-index'));
                            removeFoodFromMeal(meal, index);
                        });
                    });
                }
            }
            
            highlightSelectedMeal();
        }

        // Highlight the selected meal
        function highlightSelectedMeal() {
            for (const meal in mealContainers) {
                if (meal === selectedMeal) {
                    mealContainers[meal].style.borderColor = 'var(--secondary)';
                    mealContainers[meal].style.backgroundColor = 'rgba(33, 150, 243, 0.05)';
                } else {
                    mealContainers[meal].style.borderColor = 'var(--light-gray)';
                    mealContainers[meal].style.backgroundColor = '';
                }
            }
        }

        // Calculate total nutrition values
        function calculateTotals() {
            let totals = {
                calories: 0,
                protein: 0,
                carbs: 0,
                fat: 0,
                sugar: 0
            };
            
            for (const meal in meals) {
                meals[meal].forEach(food => {
                    totals.calories += food.calories;
                    totals.protein += food.protein;
                    totals.carbs += food.carbs;
                    totals.fat += food.fat;
                    totals.sugar += food.sugar;
                });
            }
            
            // Round to 1 decimal place
            totals.protein = Math.round(totals.protein * 10) / 10;
            totals.carbs = Math.round(totals.carbs * 10) / 10;
            totals.fat = Math.round(totals.fat * 10) / 10;
            totals.sugar = Math.round(totals.sugar * 10) / 10;
            
            return totals;
        }

        // Update nutrition summary display
        function updateNutritionSummary() {
            const totals = calculateTotals();
            
            totalCaloriesElem.textContent = totals.calories;
            proteinValue.textContent = `${totals.protein}g`;
            carbsValue.textContent = `${totals.carbs}g`;
            fatValue.textContent = `${totals.fat}g`;
            sugarValue.textContent = `${totals.sugar}g`;
            
            // Update calorie difference
            const difference = dailyGoal - totals.calories;
            calorieDifference.textContent = `${difference > 0 ? '+' : ''}${difference} calories ${difference >= 0 ? 'remaining' : 'over goal'}`;
            
            if (difference >= 0) {
                calorieDifference.className = 'calorie-difference calorie-deficit';
            } else {
                calorieDifference.className = 'calorie-difference calorie-surplus';
            }
        }

        // Set calorie goal
        function setCalorieGoal() {
            const goal = parseInt(calorieGoalInput.value);
            if (goal && goal > 0) {
                dailyGoal = goal;
                goalDisplay.textContent = dailyGoal;
                updateNutritionSummary();
                
                // Show confirmation
                const originalText = setGoalButton.textContent;
                setGoalButton.textContent = 'Goal Set!';
                setGoalButton.style.backgroundColor = '#2e7d32';
                setTimeout(() => {
                    setGoalButton.textContent = originalText;
                    setGoalButton.style.backgroundColor = '';
                }, 1500);
            }
        }

        // Initialize with sample data for demo
        function initializeSampleData() {
            // Add some sample foods to meals
            meals.breakfast.push(foodDatabases.uk[0]); // Banana
            meals.breakfast.push(foodDatabases.uk[2]); // Whole Milk
            meals.breakfast.push(foodDatabases.uk[3]); // Wholemeal Bread
            
            meals.lunch.push(foodDatabases.uk[1]); // Chicken Breast
            meals.lunch.push(foodDatabases.global[3]); // Broccoli
            meals.lunch.push(foodDatabases.global[5]); // Brown Rice
            
            meals.dinner.push(foodDatabases.usda[0]); // Ground Beef
            meals.dinner.push(foodDatabases.usda[1]); // Sweet Potato
            meals.dinner.push(foodDatabases.usda[2]); // Spinach
            
            meals.snacks.push(foodDatabases.global[4]); // Almonds
            meals.snacks.push(foodDatabases.uk[5]); // Apple
            
            // Update displays
            updateMealDisplay();
            updateNutritionSummary();
            updateChart();
            
            // Highlight breakfast as default selected meal
            selectedMeal = 'breakfast';
            highlightSelectedMeal();
        }

        // Initialize the app
        function init() {
            initializeChart();
            initializeEventListeners();
            searchFoods(); // Initial search to show UK foods
        }

        // Start the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
